<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Fan Liu, Jingxuan Wang, Nuo Chen">

<title>Final project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="final project_files/libs/clipboard/clipboard.min.js"></script>
<script src="final project_files/libs/quarto-html/quarto.js"></script>
<script src="final project_files/libs/quarto-html/popper.min.js"></script>
<script src="final project_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="final project_files/libs/quarto-html/anchor.min.js"></script>
<link href="final project_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="final project_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="final project_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="final project_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="final project_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Final project</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Fan Liu, Jingxuan Wang, Nuo Chen </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(recipes)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyclust)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dendextend)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="introduction" class="level1">
<h1>1. Introduction</h1>
<p>Since Chinese reform and opening, the Chinese economy has developed rapidly. However, due to the regional unbalanced economic developments, the economic vitality has a huge gap between different cities. At the same time, due to economic transformation and industrial structure adjustment, Chinese provinces and cities face different economic policy challenges. As a result, an objective and comprehensive evaluation of the regional economic vitality and exploring the reasons for such differences to achieve sustainable development of regional coordination is of great significance. In this research, we want to study China’s city-level economic vitality index. The regional economic dynamic is an important indicator to evaluate the economic development in China. It is a helpful indicator for understanding the regional economic development status quo and future economic potential. However, there is no single standard and definition of economic vitality. Due to the complexity of indicators and external influencing factors, it is difficult to use a single factor to estimate economic vitality. Therefore, in this research, we want to use data analysis skills to build a model for economic vitality estimation and a reference for the following study.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>city_indicators <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">"city.xlsx"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-description" class="level1">
<h1>2. Data Description</h1>
<p>In the project, we selected 269 cities in China and collected their Macro-level economic indicators. All macro-level data comes from the National Bureau of Statistics of China (NBS). We collected data from 2000 to 2020 and eliminated missing value in 2020. The final data set ranges from 2003 to 2019. Based on the research by Jin(2007), we selected 9 key indicators to estimate economic vitality：</p>
<p>X1: GDP per capita (Ten thousand yuan)</p>
<p>X2: The GDP growth rate</p>
<p>X3: Actual utilization of foreign capital(100 million dollars)</p>
<p>X4: Research funding (100 million yuan)</p>
<p>X5: Gross export (100 million yuan)</p>
<p>X6: Disposable income per capita (100 million yuan)</p>
<p>X7: General college students (Ten thousand people)</p>
<p>X8: fiscal revenue(100 million yuan)</p>
<p>X9: Park green area per capita(m2)</p>
</section>
<section id="modeling" class="level1">
<h1>3. Modeling</h1>
<section id="model-one" class="level2">
<h2 class="anchored" data-anchor-id="model-one">3.1 Model One</h2>
<section id="city-ranking" class="level3">
<h3 class="anchored" data-anchor-id="city-ranking">3.1.1 City Ranking</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the most occurring year for cross-sectional data with the largest sample size</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>getmode <span class="ot">&lt;-</span> <span class="cf">function</span>(v) {</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>   uniqv <span class="ot">&lt;-</span> <span class="fu">unique</span>(v)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>   uniqv[<span class="fu">which.max</span>(<span class="fu">tabulate</span>(<span class="fu">match</span>(v, uniqv)))]</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">getmode</span>(city_indicators<span class="sc">$</span>year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2013</code></pre>
</div>
</div>
<p>We selected the year with largest sample size through getmode, which is the year of 2013. We used the year of 2013 for our PCA analysis. We then conducted dimensionality reduction to the data in 2013 to summarize explanatory variables into 5 categories, which included 90% of the 9 independent variables that we used to estimate EV.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>city_indicators_2013 <span class="ot">&lt;-</span> city_indicators <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2013</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>First We standardizing the data by using the following formula:</p>
<p><span class="math display">\[ \tilde{\alpha} = \frac{\alpha_{ij} - \mu_j}{s_j}, i\in [1,269], j\in [1,9] \]</span> <span class="math display">\[ \mu_j = \frac{\sum^{269}_{i=1}{\alpha_{ij}}}{269}, s_j = \sqrt{\frac{\sum^{269}_{i=1}{(\alpha_{ij} - \mu_j)^2}}{269-1}} \]</span> Similarly, we define:</p>
<p><span class="math display">\[ \tilde{x_j} = \frac{x_j - \mu_j}{s_j} \]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># normalize numeric variables</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>recipe1 <span class="ot">&lt;-</span> city_indicators_2013 <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recipe</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(x1, x2, x3, x4, x5, x6, x7, x8, x9) <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, we calculate the correlation coefficient matrix: <span class="math display">\[ R = \frac{\tilde{A^T}\tilde{A}}{269-1} = \tilde{X^T}\tilde{X}, \tilde{A} = (\tilde{\alpha_{ij}})_{269*9}, \tilde{X} = (\tilde{x_j})_{9*9}  \]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># apply estimated mean and sd to original data</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>city_numeric_data <span class="ot">&lt;-</span> recipe1 <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bake</span>(<span class="at">new_data =</span> city_indicators_2013)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># look at the correlation matrix</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>heatmap_data <span class="ot">&lt;-</span> city_numeric_data <span class="sc">%&gt;%</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(x1, x2, x3, x4, x5, x6, x7, x8, x9) <span class="sc">%&gt;%</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>()</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>ID <span class="ot">&lt;-</span> <span class="fu">rownames</span>(heatmap_data)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>heatmap_data <span class="ot">&lt;-</span> <span class="fu">melt</span>(heatmap_data, <span class="at">id.vars=</span><span class="fu">c</span>(<span class="st">"ID"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">round</span>(value, <span class="at">digits =</span> <span class="dv">2</span>))</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(heatmap_data) <span class="sc">+</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">x =</span> Var1, <span class="at">y =</span> Var2, <span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low=</span><span class="st">"#003366"</span>, <span class="at">high=</span><span class="st">"#990033"</span>) <span class="sc">+</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> Var1, <span class="at">y =</span> Var2, <span class="at">label =</span> value),</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="final-project_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Generally speaking, most of the correlation coefficients are greater than 0.3, indicating that there is a certain degree of correlation among the nine indicators, so we can use PCA to reduce the data dimension.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the loadings</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>recipe2 <span class="ot">&lt;-</span> city_numeric_data <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recipe</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_pca</span>(x1, x2, x3, x4, x5, x6, x7, x8, x9) <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>(<span class="at">data =</span> city_numeric_data )</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># apply loadings to original data</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>city_pca <span class="ot">&lt;-</span> recipe2 <span class="sc">%&gt;%</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bake</span>(<span class="at">new_data =</span> city_numeric_data)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(recipe2, <span class="at">number =</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">"variance"</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(terms <span class="sc">==</span> <span class="st">"cumulative percent variance"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_min</span>(value, <span class="at">n =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  terms                       value component id       
  &lt;chr&gt;                       &lt;dbl&gt;     &lt;int&gt; &lt;chr&gt;    
1 cumulative percent variance  54.5         1 pca_lMWcm
2 cumulative percent variance  67.6         2 pca_lMWcm
3 cumulative percent variance  78.0         3 pca_lMWcm
4 cumulative percent variance  86.8         4 pca_lMWcm
5 cumulative percent variance  92.7         5 pca_lMWcm</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(recipe2, <span class="at">number =</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">"variance"</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(terms <span class="sc">==</span> <span class="st">"percent variance"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(value, <span class="at">n =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  terms            value component id       
  &lt;chr&gt;            &lt;dbl&gt;     &lt;int&gt; &lt;chr&gt;    
1 percent variance 54.5          1 pca_lMWcm
2 percent variance 13.1          2 pca_lMWcm
3 percent variance 10.4          3 pca_lMWcm
4 percent variance  8.81         4 pca_lMWcm
5 percent variance  5.87         5 pca_lMWcm</code></pre>
</div>
</div>
<p>The cumulative contribution rate of the first five principal components exceeds 90%, so we omited the 6th to 9th eigenvalues and keep the first five principal components</p>
<p>Finally, we select the first 5 principal components to evaluate economic vitality <span class="math display">\[ EV = 0.54504299Z_1   + 0.13074307Z_2 + 0.10420985Z_3 + 0.08814061Z_4 + 0.05870141Z_5 \]</span> We use the 5 components to evaluate economic vitality and estimated the EV score of the 269 cities. The results are as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>pca_numeric_2013 <span class="ot">&lt;-</span> city_pca <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"PC"</span>))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  pca_numeric_2013 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(pca_numeric_2013)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>coef1 <span class="ot">&lt;-</span> <span class="fu">tidy</span>(recipe2, <span class="at">number =</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">"variance"</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(terms <span class="sc">==</span> <span class="st">"percent variance"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(value, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(value)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>coef1 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(coef1) </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  coef1 <span class="ot">&lt;-</span> coef1 <span class="sc">/</span> <span class="dv">100</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  EV_score_2013 <span class="ot">&lt;-</span> pca_numeric_2013 <span class="sc">%*%</span> coef1</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>city_2013_EV <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(<span class="fu">select</span>(city_pca, city, city_name),</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>                            <span class="at">EV_score =</span> EV_score_2013)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>city_2013_EV <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EV_rank =</span> <span class="fu">case_when</span>(EV_score <span class="sc">&lt;=</span> <span class="sc">-</span><span class="fl">0.617</span> <span class="sc">~</span> <span class="st">"1st Qu"</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                             EV_score <span class="sc">&gt;</span> <span class="sc">-</span><span class="fl">0.617</span> <span class="sc">&amp;</span>  EV_score <span class="sc">&lt;=</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"2nd Qu "</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                             EV_score <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span>  EV_score <span class="sc">&lt;=</span> <span class="fl">0.1768</span> <span class="sc">~</span> <span class="st">"3rd Qu "</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                             EV_score <span class="sc">&gt;</span> <span class="fl">0.1768</span> <span class="sc">~</span> <span class="st">"4th Qu"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> EV_rank,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y=</span> EV_score),</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.4</span>,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> (<span class="fu">paste</span>(<span class="st">"The Distribution and Comparison of the Economic Vitality of Chinese Cities"</span>)),</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">"Data: National Bureau of Statistics of China"</span>,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Economic vitality score distribution"</span>,</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Economic vitality score"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="final-project_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>ev_plot <span class="ot">&lt;-</span> city_2013_EV <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(city_name, EV_score) <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(EV_score <span class="sc">&gt;=</span> <span class="dv">1</span>) </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">data =</span> ev_plot, </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> EV_score, </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="fu">reorder</span>(city_name, EV_score)),</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> (<span class="fu">paste</span>(<span class="st">"The specific scores of cities with high economic vitality</span><span class="sc">\n</span><span class="st">in China"</span>)),</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"City Name"</span>,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Data: National Bureau of Statistics of China"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="final-project_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> city_pca, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(PC1, PC2), </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">filter</span>(city_pca, PC1 <span class="sc">&gt;=</span> <span class="dv">5</span>),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(PC1, PC2, <span class="at">label =</span> city_name),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"PC1 and PC2 for City Data in 2013"</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"PC1 (0.55 of Variation)"</span>,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"PC2 (0.13 of Variation)"</span>,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Data: National Bureau of Statistics of China"</span>) <span class="sc">+</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="final-project_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We visualized the estimated EV score by different quantiles. From the result, we can see that the top quantile accounted for the most amount of the EV score. The four outliers, including Shanghai, Shenzhen, Beijing, and Tianjin, had higher EV scores than other cities in the dataset. From the result, we can conclude that large cities have better economic vitality, especially in the economic sector. The economic development trend is still centered in the larger cities, which will attract more talent and capital. Another trend in the visualization is that most cities in China have relatively low EV scores. The average is 0, and more than 50% of cities have EV scores below 0. The result shows that the economic development between large and small cities is highly unequal.</p>
</section>
<section id="cluster-analysis" class="level3">
<h3 class="anchored" data-anchor-id="cluster-analysis">3.1.2 Cluster Analysis</h3>
<p>Based on the data in 2013, we plan to classify the 269 cities according to common characteristics, so as to facilitate the subsequent policy analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>kmeans_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> <span class="sc">~</span> .,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> city_indicators_2013) <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">step_select</span>(<span class="fu">all_numeric</span>())</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>city_numeric <span class="ot">&lt;-</span> kmeans_rec <span class="sc">%&gt;%</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bake</span>(<span class="at">new_data =</span> city_indicators_2013)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20221126</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(city_numeric, <span class="at">FUN =</span> kmeans, <span class="at">method =</span> <span class="st">"wss"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="final-project_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(city_numeric, <span class="at">FUN =</span> kmeans, <span class="at">method =</span> <span class="st">"silhouette"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="final-project_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(city_numeric, <span class="at">FUN =</span> kmeans, <span class="at">method =</span> <span class="st">"gap_stat"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="final-project_files/figure-html/unnamed-chunk-11-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In the selection of K, we have two optimal choices of K = 2 and K = 7.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a kmeans model object four clusters</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>city_kmeans_spec <span class="ot">&lt;-</span> <span class="fu">k_means</span>(<span class="at">num_clusters =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co"># number of clusters</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"stats"</span>, <span class="at">nstart =</span> <span class="dv">100</span>) <span class="co"># number of random starts</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># create a workflow</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>city_kmeans_wflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>(<span class="at">preprocessor =</span> kmeans_rec,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">spec =</span> city_kmeans_spec)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># fit the model</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>city_kmeans_2 <span class="ot">&lt;-</span> city_kmeans_wflow <span class="sc">%&gt;%</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> city_indicators_2013)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>city_kmeans_spec <span class="ot">&lt;-</span> <span class="fu">k_means</span>(<span class="at">num_clusters =</span> <span class="dv">7</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"stats"</span>, <span class="at">nstart =</span> <span class="dv">100</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>city_kmeans_wflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>(<span class="at">preprocessor =</span> kmeans_rec,</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>                               <span class="at">spec =</span> city_kmeans_spec)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>city_kmeans_7 <span class="ot">&lt;-</span> city_kmeans_wflow <span class="sc">%&gt;%</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> city_indicators_2013)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>city_clusters <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(city_pca, </span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>                           <span class="at">cluster2 =</span> city_kmeans_2 <span class="sc">%&gt;%</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">extract_cluster_assignment</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">pull</span>(.cluster),</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>                           <span class="at">cluster7 =</span> city_kmeans_7 <span class="sc">%&gt;%</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">extract_cluster_assignment</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">pull</span>(.cluster))</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> city_clusters,</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(PC1, PC2, <span class="at">color =</span> <span class="fu">factor</span>(cluster2)),</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">filter</span>(city_pca, PC1 <span class="sc">&gt;=</span> <span class="dv">5</span>),</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(PC1, PC2, <span class="at">label =</span> city_name),</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"K-Means with K=2 and PCA"</span>,</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"PC1 (0.55 of Variation)"</span>,</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"PC2 (0.13 of Variation)"</span>) <span class="sc">+</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">text =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="final-project_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">dist</span>(city_numeric_data, <span class="at">method =</span> <span class="st">"euclidean"</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>hclust_euc <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">hclust</span>(d1, <span class="at">method =</span> <span class="st">"ward.D2"</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hclust_euc, <span class="at">cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(hclust_euc, <span class="at">k =</span> <span class="dv">2</span>, <span class="at">border =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="final-project_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>sub_grp1 <span class="ot">&lt;-</span> <span class="fu">cutree</span>(hclust_euc, <span class="at">k =</span> <span class="dv">2</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(<span class="fu">list</span>(<span class="at">data =</span> city_numeric_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"x"</span>)), </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> sub_grp1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="final-project_files/figure-html/unnamed-chunk-12-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> city_clusters,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(PC1, PC2, <span class="at">color =</span> <span class="fu">factor</span>(cluster7)),</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">filter</span>(city_pca, PC1 <span class="sc">&gt;=</span> <span class="dv">5</span>),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(PC1, PC2, <span class="at">label =</span> city_name),</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"K-Means with K=7 and PCA"</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"PC1 (0.55 of Variation)"</span>,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"PC2 (0.13 of Variation)"</span>) <span class="sc">+</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">text =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="final-project_files/figure-html/unnamed-chunk-12-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">dist</span>(city_numeric_data, <span class="at">method =</span> <span class="st">"euclidean"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>hclust_euc <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">hclust</span>(d2, <span class="at">method =</span> <span class="st">"ward.D2"</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hclust_euc, <span class="at">cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(hclust_euc, <span class="at">k =</span> <span class="dv">7</span>, <span class="at">border =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="final-project_files/figure-html/unnamed-chunk-12-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>sub_grp2 <span class="ot">&lt;-</span> <span class="fu">cutree</span>(hclust_euc, <span class="at">k =</span> <span class="dv">7</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(<span class="fu">list</span>(<span class="at">data =</span> city_numeric_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"x"</span>)), </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> sub_grp2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="final-project_files/figure-html/unnamed-chunk-12-6.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>city_2013_k2 <span class="ot">&lt;-</span> city_indicators_2013 <span class="sc">%&gt;%</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"x"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cluster =</span> sub_grp1) <span class="sc">%&gt;%</span> </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ev_score =</span> EV_score_2013) </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>city_2013_k2 <span class="sc">%&gt;%</span> </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cluster) <span class="sc">%&gt;%</span> </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">mean</span>(x1), <span class="fu">mean</span>(x2), <span class="fu">mean</span>(x3), <span class="fu">mean</span>(x4), <span class="fu">mean</span>(x5), <span class="fu">mean</span>(x6), </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mean</span>(x7), <span class="fu">mean</span>(x8), <span class="fu">mean</span>(x9), <span class="fu">mean</span>(ev_score)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">cluster</th>
<th style="text-align: right;">mean(x1)</th>
<th style="text-align: right;">mean(x2)</th>
<th style="text-align: right;">mean(x3)</th>
<th style="text-align: right;">mean(x4)</th>
<th style="text-align: right;">mean(x5)</th>
<th style="text-align: right;">mean(x6)</th>
<th style="text-align: right;">mean(x7)</th>
<th style="text-align: right;">mean(x8)</th>
<th style="text-align: right;">mean(x9)</th>
<th style="text-align: right;">mean(ev_score)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">4.662</td>
<td style="text-align: right;">9.808</td>
<td style="text-align: right;">6.261</td>
<td style="text-align: right;">4.643</td>
<td style="text-align: right;">254.402</td>
<td style="text-align: right;">24132.33</td>
<td style="text-align: right;">7.453</td>
<td style="text-align: right;">148.636</td>
<td style="text-align: right;">3.373</td>
<td style="text-align: right;">-0.207</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">11.583</td>
<td style="text-align: right;">10.811</td>
<td style="text-align: right;">84.598</td>
<td style="text-align: right;">80.447</td>
<td style="text-align: right;">5293.527</td>
<td style="text-align: right;">36288.00</td>
<td style="text-align: right;">49.334</td>
<td style="text-align: right;">1579.576</td>
<td style="text-align: right;">21.297</td>
<td style="text-align: right;">4.079</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>city_2013_k7 <span class="ot">&lt;-</span> city_indicators_2013 <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"x"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cluster =</span> sub_grp2) <span class="sc">%&gt;%</span> </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ev_score =</span> EV_score_2013) </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>city_2013_k7 <span class="sc">%&gt;%</span> </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cluster) <span class="sc">%&gt;%</span> </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(<span class="fu">mean</span>(x1), <span class="fu">mean</span>(x2), <span class="fu">mean</span>(x3), <span class="fu">mean</span>(x4), <span class="fu">mean</span>(x5), <span class="fu">mean</span>(x6), </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mean</span>(x7), <span class="fu">mean</span>(x8), <span class="fu">mean</span>(x9), <span class="fu">mean</span>(ev_score)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">cluster</th>
<th style="text-align: right;">mean(x1)</th>
<th style="text-align: right;">mean(x2)</th>
<th style="text-align: right;">mean(x3)</th>
<th style="text-align: right;">mean(x4)</th>
<th style="text-align: right;">mean(x5)</th>
<th style="text-align: right;">mean(x6)</th>
<th style="text-align: right;">mean(x7)</th>
<th style="text-align: right;">mean(x8)</th>
<th style="text-align: right;">mean(x9)</th>
<th style="text-align: right;">mean(ev_score)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.083</td>
<td style="text-align: right;">12.787</td>
<td style="text-align: right;">2.812</td>
<td style="text-align: right;">2.436</td>
<td style="text-align: right;">76.250</td>
<td style="text-align: right;">21369.29</td>
<td style="text-align: right;">3.798</td>
<td style="text-align: right;">86.518</td>
<td style="text-align: right;">2.421</td>
<td style="text-align: right;">-0.634</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4.081</td>
<td style="text-align: right;">6.115</td>
<td style="text-align: right;">4.689</td>
<td style="text-align: right;">3.567</td>
<td style="text-align: right;">109.827</td>
<td style="text-align: right;">23691.56</td>
<td style="text-align: right;">4.644</td>
<td style="text-align: right;">123.361</td>
<td style="text-align: right;">2.771</td>
<td style="text-align: right;">-0.191</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">11.574</td>
<td style="text-align: right;">8.110</td>
<td style="text-align: right;">13.655</td>
<td style="text-align: right;">11.058</td>
<td style="text-align: right;">1138.633</td>
<td style="text-align: right;">34261.69</td>
<td style="text-align: right;">7.443</td>
<td style="text-align: right;">293.033</td>
<td style="text-align: right;">7.652</td>
<td style="text-align: right;">0.903</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">14.952</td>
<td style="text-align: right;">8.053</td>
<td style="text-align: right;">126.519</td>
<td style="text-align: right;">246.167</td>
<td style="text-align: right;">8278.499</td>
<td style="text-align: right;">42086.18</td>
<td style="text-align: right;">54.700</td>
<td style="text-align: right;">3885.309</td>
<td style="text-align: right;">14.805</td>
<td style="text-align: right;">7.930</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">11.617</td>
<td style="text-align: right;">11.255</td>
<td style="text-align: right;">93.783</td>
<td style="text-align: right;">50.074</td>
<td style="text-align: right;">3461.829</td>
<td style="text-align: right;">33858.09</td>
<td style="text-align: right;">64.180</td>
<td style="text-align: right;">1319.476</td>
<td style="text-align: right;">9.809</td>
<td style="text-align: right;">3.152</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">9.247</td>
<td style="text-align: right;">11.466</td>
<td style="text-align: right;">32.159</td>
<td style="text-align: right;">50.959</td>
<td style="text-align: right;">8188.075</td>
<td style="text-align: right;">38902.33</td>
<td style="text-align: right;">6.168</td>
<td style="text-align: right;">736.017</td>
<td style="text-align: right;">56.262</td>
<td style="text-align: right;">3.983</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">7.200</td>
<td style="text-align: right;">10.445</td>
<td style="text-align: right;">26.542</td>
<td style="text-align: right;">15.108</td>
<td style="text-align: right;">772.908</td>
<td style="text-align: right;">28963.41</td>
<td style="text-align: right;">48.253</td>
<td style="text-align: right;">478.939</td>
<td style="text-align: right;">6.020</td>
<td style="text-align: right;">0.882</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Through expert check and visualization with PCA, we judge that both clusters have very high quality (there are large differences between groups). k = 2 shows differences in all nine feature means, especially on PC1 and PC2. This is also directly reflected in the ev_score of the two groups; that is, they represent the two types of cities with low urban economic vitality and high urban economic vitality in China. When k = 7, several groups except cluster 4 have a commonality in ev_score (cluster 5 is similar to 6, and the remaining four groups are similar). However, their differences are more detailed in different characteristics. We can find out the advantages and disadvantages of developing a certain cluster city by comparing specific groups to provide policy recommendations in more detail. We can further compare the advantages and disadvantages of the two clustering through a stability analysis. However, since this paper is an application of the existing method of analyzing the economic vitality of Chinese cities using nine characteristics in the literature, it does not consider the selection of variables through the robustness test and further optimization of the model in the paper.</p>
</section>
</section>
<section id="model-two" class="level2">
<h2 class="anchored" data-anchor-id="model-two">3.2 Model Two</h2>
<p>In this section, we will select a representative from each cluster for short-term and long-term policy analysis. Weihai is the representative of cluster1, and Beijing is the representative of cluster2. In this part, we conduct PCA analysis on the entire panel data and use this to judge the changes in the economic vitality of each city over time. At the same time, we will also pay attention to the relationship between urban economic vitality and the changing trend of principal components.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>  recipe <span class="ot">&lt;-</span> city_indicators  <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recipe</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(x1, x2, x3, x4, x5, x6, x7, x8, x9) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>()</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  numeric_dataframe <span class="ot">&lt;-</span> recipe <span class="sc">%&gt;%</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bake</span>(<span class="at">new_data =</span> city_indicators)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  recipe_new <span class="ot">&lt;-</span> numeric_dataframe <span class="sc">%&gt;%</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recipe</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_pca</span>(x1, x2, x3, x4, x5, x6, x7, x8, x9) <span class="sc">%&gt;%</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>(numeric_dataframe)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  pca <span class="ot">&lt;-</span> recipe_new <span class="sc">%&gt;%</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bake</span>(<span class="at">new_data =</span> numeric_dataframe)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  pca_numeric <span class="ot">&lt;-</span> pca <span class="sc">%&gt;%</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"PC"</span>))</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  pca_numeric <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(pca_numeric)</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  coef2 <span class="ot">&lt;-</span> <span class="fu">tidy</span>(recipe_new, <span class="at">number =</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">"variance"</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(terms <span class="sc">==</span> <span class="st">"percent variance"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(value, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(value)</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>  coef2 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(coef2) </span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>  coef2 <span class="ot">&lt;-</span> coef2 <span class="sc">/</span> <span class="dv">100</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>  EV_score <span class="ot">&lt;-</span> pca_numeric <span class="sc">%*%</span> coef2</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>  EV <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(<span class="fu">select</span>(pca, year,city_name, PC1, PC2, PC3, PC4, PC5),</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ev_score =</span> EV_score)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">data =</span> EV,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.character</span>(year),</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y =</span> ev_score),</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.4</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">filter</span>(EV, ev_score <span class="sc">&gt;=</span> <span class="dv">5</span>),</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="fu">as.character</span>(year), ev_score, <span class="at">label =</span> city_name),</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> (<span class="fu">paste</span>(<span class="st">"Overall Changes in the Economic Vitality of Chinese Cities"</span>)),</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">"Data: National Bureau of Statistics of China"</span>,</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Economic vitality score"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="final-project_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the figure, we can see that the economic vitality of cities in China has not changed much and is still at a low level. However, the cities represented by Shanghai and Beijing are developing rapidly and their development level is significantly higher than the average level.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(recipe_new, <span class="at">number =</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">"coef"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 81 × 4
   terms   value component id       
   &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;    
 1 x1     0.355  PC1       pca_XGxiE
 2 x2    -0.0972 PC1       pca_XGxiE
 3 x3     0.388  PC1       pca_XGxiE
 4 x4     0.391  PC1       pca_XGxiE
 5 x5     0.369  PC1       pca_XGxiE
 6 x6     0.331  PC1       pca_XGxiE
 7 x7     0.283  PC1       pca_XGxiE
 8 x8     0.417  PC1       pca_XGxiE
 9 x9     0.250  PC1       pca_XGxiE
10 x1    -0.341  PC2       pca_XGxiE
# … with 71 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(recipe_new, <span class="at">number =</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">"variance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 36 × 4
   terms                value component id       
   &lt;chr&gt;                &lt;dbl&gt;     &lt;int&gt; &lt;chr&gt;    
 1 variance            4.76           1 pca_XGxiE
 2 variance            1.37           2 pca_XGxiE
 3 variance            0.899          3 pca_XGxiE
 4 variance            0.732          4 pca_XGxiE
 5 variance            0.554          5 pca_XGxiE
 6 variance            0.270          6 pca_XGxiE
 7 variance            0.224          7 pca_XGxiE
 8 variance            0.145          8 pca_XGxiE
 9 variance            0.0514         9 pca_XGxiE
10 cumulative variance 4.76           1 pca_XGxiE
# … with 26 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>df_beijing <span class="ot">&lt;-</span> EV <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(city_name <span class="sc">==</span> <span class="st">"Bei Jing "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, PC1, PC2, PC3, PC4, PC5, ev_score)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> df_beijing) <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> ev_score), <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> ev_score)) <span class="sc">+</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> PC1), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> PC1), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> PC2), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> PC2), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> PC3), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> PC3), <span class="at">color =</span> <span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> PC4), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"yellow"</span>) <span class="sc">+</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> PC4), <span class="at">color =</span> <span class="st">"yellow"</span>) <span class="sc">+</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> PC5), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"orange"</span>) <span class="sc">+</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> PC5), <span class="at">color =</span> <span class="st">"orange"</span>) <span class="sc">+</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2003</span>, <span class="dv">2007</span>, <span class="dv">2011</span>, <span class="dv">2015</span>, <span class="dv">2019</span>))  <span class="sc">+</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> (<span class="fu">paste</span>(<span class="st">"Beijing's urban economic vitality and the changing trend</span><span class="sc">\n</span><span class="st">of each principal component"</span>)),</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">subtitle =</span> <span class="st">"Black: Economic Vitality, Red: PC1, Blue: PC2,</span><span class="sc">\n</span><span class="st">Green: PC3, Yellow: PC4, Orange: PC5"</span>,</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">"Data: National Bureau of Statistics of China"</span>,</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Economic vitality score"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="final-project_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="explanations-for-each-pc-line" class="level3">
<h3 class="anchored" data-anchor-id="explanations-for-each-pc-line">3.2.1 Explanations for each PC line:</h3>
<ul>
<li><p>PC1 line in red emphasizes X1, X3, X4, X8, which are all related to the financial revenues, with these four values above 0.35.</p></li>
<li><p>PC2 line in blue is mostly determined by x2 (GDP growth rate) which amounts to 0.67.</p></li>
<li><p>PC3 line in green is mainly driven by x9 (park green area per capita) which accounts for 0.75.</p></li>
<li><p>PC4 line in yellow focuses on x4 (research capital) which amounts to 0.38.</p></li>
<li><p>PC5 line in orange focuses most equally on x1(GDP per capita, 0.44), x2 (GDP growth rate, 0.56), and x6 (disposable income per capita, 0.41).</p></li>
</ul>
</section>
<section id="a-brief-study-on-beijing" class="level3">
<h3 class="anchored" data-anchor-id="a-brief-study-on-beijing">3.2.2 A brief study on Beijing</h3>
<p>Based on the graph, we can find that the red line (PC1) is the main contributor to EV in Beijing, with a significant upward trend during the analysis. PC1 emphasizes X1, X3, X4, X8 with all these four values above 0.35, within which X8 (the fiscal revenue) makes the biggest contribution to the performance of PC1. We can conclude that factors related to fiscal revenue have an essentially positive relationship with EV. We witness a negative value of X2 (the GDP growth rate) in PC1, which makes sense because it is difficult for Beijing, having such an enormous economic volume, to own a large GDP growth rate. However, the green line (PC3), which focuses on X9 (park green area) having a value of 0.75, directs downward with EV scores below 0 in general. We conclude that environmental factors play an insignificant role in Beijing’s economic vitality development.</p>
<p>We take a closer look at the time from 2016 to 2017, when EV in Beijing shows an obvious increase. PC1 accounts for this abrupt rise because it has the largest slope and compensates for the decrease of PC3 and PC5. This result corresponds with the conclusion we make above; that is, the X8 (the fiscal revenue), the most important part of PC1, contributes most to the development of EV in Beijing. Generally, factors related to the fiscal revenue matter most to the EV in Beijing, while the environmental factors matter least. We conclude that EV for the cluster of cities represented by Beijing is closely related to factors like fiscal revenue. Besides, as a policy suggestion, we think that governments of cities within this cluster can invest more in environmental aspects, which could be a new growth incentive after the post-2017 slowdown of EV.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>  df_weihai <span class="ot">&lt;-</span> EV <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(city_name <span class="sc">==</span> <span class="st">"Wei Hai "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, PC1, PC2, PC3, PC4, PC5, ev_score)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> df_weihai) <span class="sc">+</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> ev_score), <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> ev_score)) <span class="sc">+</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> PC1), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> PC1), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> PC2), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> PC2), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> PC3), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> PC3), <span class="at">color =</span> <span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> PC4), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"yellow"</span>) <span class="sc">+</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> PC4), <span class="at">color =</span> <span class="st">"yellow"</span>) <span class="sc">+</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> PC5), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"orange"</span>) <span class="sc">+</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> PC5), <span class="at">color =</span> <span class="st">"orange"</span>) <span class="sc">+</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2004</span>, <span class="dv">2008</span>, <span class="dv">2012</span>, <span class="dv">2016</span>, <span class="dv">2020</span>))  <span class="sc">+</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> (<span class="fu">paste</span>(<span class="st">"Weihai's urban economic vitality and the changing trend</span><span class="sc">\n</span><span class="st">of each principal component"</span>)),</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">subtitle =</span> <span class="st">"Black: Economic Vitality, Red: PC1, Blue: PC2,</span><span class="sc">\n</span><span class="st">Green: PC3, Yellow: PC4, Orange: PC5"</span>,</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">"Data: National Bureau of Statistics of China"</span>,</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Economic vitality score"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="final-project_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="a-brief-study-on-weihai" class="level3">
<h3 class="anchored" data-anchor-id="a-brief-study-on-weihai">3.2.3 A brief study on Weihai</h3>
<p>As we mentioned above, factors related to fiscal revenue have an essentially positive relationship with EV shown by PC1. PC3 is mainly driven by x9 (park green area per capita, 0.75), and PC2 is mainly driven by x2 (GDP growth rate, 0.67). In this sense, Beijing’s EV relies heavily on its fiscal revenues and performs much worse in environmental terms. For a less developed city like Weihai, fiscal revenue remains an important driver of its EV, but performs relatively well on the environmental dimension. We also witness a surprisingly year-to-year decline in EV mainly determined by the GDP growth rate in Weihai, especially after the COVID-19 outbreak in 2019.</p>
</section>
</section>
</section>
<section id="conclusions-and-policy-alternatives" class="level1">
<h1><strong>4. Conclusions and Policy Alternatives</strong></h1>
<p>The differences between Beijing and Weihai are mainly related to the development constraints and political agenda of urban development in China. Several studies show that the environment protection and urbanization development are in the strong mutual restriction state with non-benign coupling and uncoordinated (Wang et al., 2013, Xu et al., 2019, She et al., 2021). The above visualization results show that China has neglected the collaboration between urban development and the environment protection in the time period studied by this paper, namely before 2019. Wang et al, (2009) argue that this is because the Chinese government has addressed the problem more from the surface of pollution than from its root causes. In particular, Beijing’s EV, driven mainly by park green area per capita, continued to decline, which was a major challenge posed by economic development on environmental pollution. However, with President Xi Jinping’s emphasis on the importance of environmental governance in his 13th Five-Year Plan from 2016 to 2020, Beijing achieved three consecutive years of growth in environment-related urban dynamism from 2017 to 2019, but unfortunately, with that, revenue-related urban dynamism seems to have entered a weak patch. Investment in environmental governance at the expense of economic development is also currently a major concern for many countries other than China, for example, Fu and Li (2020) find that the increase of GDP per capita is associated with the more severe PM2.5 pollution.</p>
<p>Furthermore, we believe that our visualization results are highly consistent with the political agenda of urban development in China. In addition to the advantage as the capital, Beijing, collaborating with Tianjin and Hebei, forms one of the leading urban agglomerations in China, which means that the three regions are encouraged to build a high level of cooperation in economic development. Li et al.&nbsp;(2022), using the data from 2003 to 2017, find that urban agglomeration, a development mode, with more development enthusiasm gave play to regional advantages and achieved coordinated development than single region, with attracting lots of investment from the central government and the individual investors. On the contrary, Weihai, as a single city, lacks collaborative assistance and financial investment in economic development.</p>
<p>We propose two policy alternatives, that is, to raise the importance of environmental issues at the national strategic level and to accelerate the energy transition to break the mutual constraint between economic development and environmental protection. We suggest that the Chinese government should introduce policies to bring more development opportunities to marginal cities such as Weihai in the post-epidemic era when the economic development of first-tier cities such as Beijing has slowed down. Ang the formation of an urban agglomeration with neighboring Qingdao and Jinan, which are more well-developed cities, is a feasible and highly profitable policy option. In addition, how to break the constraint between economic development and environmental protection should be an urgent consideration for all economists and environmental advocates. We believe that the renewable energy transition will not only effectively solve the problem of energy scarcity in industrial development, but also promote the emergence of Chinese industries such as photovoltaics, wind energy, and lithium batteries, thus ensuring the continued cites’ EV (Marrone &amp; Montella, 2022).</p>
<p><strong>Bibliography</strong></p>
<p>Fu, Z., &amp; Li, R. (2020). The contributions of socioeconomic indicators to global PM2.5 based on the hybrid method of spatial econometric model and geographical and temporal weighted regression. <em>Science of The Total Environment</em>, <em>703</em>, 135481. https://doi.org/10.1016/j.scitotenv.2019.135481</p>
<p>Jin, Y. J. (n.d.). <em>中国城市经济活力</em>. Wanfang Data. Retrieved December 11, 2022, from http://www.wanfangdata.com.cn/details/detail.do?_type=perio&amp;id=dlk+x200701002</p>
<p>&nbsp;</p>
<p>Li, X., Lu, Z., Hou, Y., Zhao, G., &amp; Zhang, L. (2022). The coupling coordination degree between urbanization and air environment in the beijing(jing)-tianjin(jin)-hebei(ji) urban agglomeration. <em>Ecological Indicators</em>, <em>137</em>, 108787. <a href="https://doi.org/10.1016/j.ecolind.2022.108787"><u>https://doi.org/10.1016/j.ecolind.2022.108787</u></a>&nbsp;</p>
<p>&nbsp;</p>
<p>Marrone, P., &amp; Montella, I. (2022). An experimentation on the limits and potential of renewable energy communities in the built city: Buildings and proximity open spaces for energy decentralization. <em>Renewable and Sustainable Energy Transition</em>, <em>2</em>, 100025. <a href="https://doi.org/10.1016/j.rset.2022.100025"><u>https://doi.org/10.1016/j.rset.2022.100025</u></a>&nbsp;</p>
<p>&nbsp;</p>
<p>She, Q., Cao, S., Zhang, S., Zhang, J., Zhu, H., Bao, J., Meng, X., Liu, M., &amp; Liu, Y. (2021). The impacts of comprehensive urbanization on PM2.5 concentrations in the Yangtze River Delta, China. <em>Ecological Indicators</em>, <em>132</em>, 108337. https://doi.org/10.1016/j.ecolind.2021.108337</p>
<p>&nbsp;</p>
<p>Wang, Y. Q., Zhang, X. Y., &amp; Draxler, R. R. (2009). TrajStat: GIS-based software that uses various trajectory statistical analysis methods to identify potential sources from long-term air pollution measurement data. <em>Environmental Modelling &amp; Software</em>, <em>24</em>(8), 938–939. https://doi.org/10.1016/j.envsoft.2009.01.004</p>
<p>&nbsp;</p>
<p>Wang, Y. Q., Zhang, X. Y., &amp; Draxler, R. R. (2009). TrajStat: GIS-based software that uses various trajectory statistical analysis methods to identify potential sources from long-term air pollution measurement data. <em>Environmental Modelling &amp; Software</em>, <em>24</em>(8), 938–939. https://doi.org/10.1016/j.envsoft.2009.01.004</p>
<p>&nbsp;</p>
<p>Xu, S.-C., Miao, Y.-M., Gao, C., Long, R.-Y., Chen, H., Zhao, B., &amp; Wang, S.-X. (2019). Regional differences in impacts of economic growth and urbanization on air pollutants in China based on provincial panel estimation. <em>Journal of Cleaner Production</em>, <em>208</em>, 340–352. https://doi.org/10.1016/j.jclepro.2018.10.114</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>